# 1396. Design Underground System

- Time complexity : O(1) for all.
- Space complexity : O(P+S^2), where S is the number of stations on the network, and P is the number of passengers making a journey concurrently during peak time.

```java
class CheckInInfo {
    String station;
    int time;

    public CheckInInfo(String station, int time) {
        this.station = station;
        this.time = time;
    }
}

class UndergroundSystem {
    Map<Integer, CheckInInfo> checkInMap;
    Map<String, int[]> tripMap; // int[totalTime, count];

    public UndergroundSystem() {
        checkInMap = new HashMap<>();
        tripMap = new HashMap<>();
    }
    
    public void checkIn(int id, String stationName, int t) {
        checkInMap.put(id, new CheckInInfo(stationName, t));
    }
    
    public void checkOut(int id, String stationName, int t) {
        CheckInInfo checkInInfo = checkInMap.get(id);
        checkInMap.remove(id);

        String key = checkInInfo .station + "->" + stationName;
        int travalTime = t - checkInInfo.time;
        
        if (!tripMap.containsKey(key)) {
            tripMap.put(key, new int[2]);
        }

        int[] time = tripMap.get(key);
        time[0] += travalTime;
        time[1] += 1;
    }
    
    public double getAverageTime(String startStation, String endStation) {
        String key = startStation + "->" + endStation;
        int[] tripStats = tripMap.get(key);
        return (double)tripStats[0] / tripStats[1];
    }
}

/**
 * Your UndergroundSystem object will be instantiated and called as such:
 * UndergroundSystem obj = new UndergroundSystem();
 * obj.checkIn(id,stationName,t);
 * obj.checkOut(id,stationName,t);
 * double param_3 = obj.getAverageTime(startStation,endStation);
 */
```